#include "UART.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CUART::Init(char* szCOMName)
{
	mszCOMName.Init(szCOMName);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CUART::Kill(void)
{
	mszCOMName.Kill();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CUART::Open(void)
{
	mhSerial = OpenWindowsCOMPort(mszCOMName.Text());
	return IsWindowsCOMPortSuccess(mhSerial);

}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CUART::Close(void)
{
	CloseWindowsCOMPort(mhSerial);
	return true;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CUART::Send(char* szMessage, CChars* pszResult)
{
	CChars	szSend;
	bool	bResult;

	szSend.Init(szMessage);
	szSend.AppendNewLine();
	bResult = SendToWindowsCOMPort(mhSerial, szSend.Text(), pszResult);
	szSend.Kill();
	return bResult;
}

